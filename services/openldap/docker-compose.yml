---
version: '2'

services:
  openldap:
    image: bitnami/openldap:2.6
    restart: always
    ports:
      - '1389:1389'
      - '1636:1636'
    environment:
      - LDAP_ADMIN_USERNAME=admin
      - LDAP_ADMIN_PASSWORD=adminpassword
      - LDAP_ROOT=dc=vnmntn,dc=com
      - LDAP_USERS=user01,user02
      - LDAP_PASSWORDS=password1,password2
    volumes:
      - './data:/bitnami/openldap'
  lam:
    image: ldapaccountmanager/lam:stable
    restart: always
    ports:
      - 8080:80
    environment:
      # skip LAM preconfiguration (lam.conf + config.cfg), values: (true/false)
      # If set to true the other variables below have no effect.
      - LAM_SKIP_PRECONFIGURE=false
      # domain of LDAP database root entry, will be converted to dc=...,dc=...
      - LDAP_DOMAIN=vnmntn.com
      # LDAP base DN to overwrite value generated by LDAP_DOMAIN
      - LDAP_BASE_DN=dc=vnmntn,dc=com
      # LDAP users DN to overwrite value provided by LDAP_BASE_DN
      - LDAP_USERS_DN=ou=people,dc=vnmntn,dc=com
      # LDAP groups DN to overwrite value provided by LDAP_BASE_DN
      - LDAP_GROUPS_DN=ou=groups,dc=vnmntn,dc=com
      # LDAP server URL
      - LDAP_SERVER=ldap://openldap:1389
      # LDAP admin user (set as login user for LAM)
      - LDAP_USER=cn=admin,dc=vnmntn,dc=com
      # default language, e.g. en_US, de_DE, fr_FR, ...
      - LAM_LANG=en_US
      # LAM configuration master password and password for server profile "lam"
      - LAM_PASSWORD=lam
      # configuration database (files or mysql)
      - LAM_CONFIGURATION_DATABASE=files
      # LAM Pro license (line breaks can be removed)
      #- LAM_LICENSE=
      # deactivate TLS certificate checks, activate for development only
      - LAM_DISABLE_TLS_CHECK=true
      # LDAP organisation name for OpenLDAP
      - LDAP_ORGANISATION="LDAP"
      # LDAP admin password
      - LDAP_ADMIN_PASSWORD=adminpassword
      # password for LDAP read-only user
      - LDAP_READONLY_USER_PASSWORD=readonlypw
