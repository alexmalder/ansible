- name: Get list of repos
  ansible.builtin.uri:
    url: "https://{{ GIT_URL }}/api/v4/groups/{{ item.group_id }}/projects?per_page=1024&include_subgroups=true"
    method: GET
    status_code:
      - 200
    return_content: true
    body_format: json
    headers:
      Content-Type: application/json
      PRIVATE-TOKEN: "{{ PRIVATE_TOKEN }}"
    validate_certs: false
  register: result

- name: Pull group
  ansible.builtin.include_tasks: ./tasks/pull-group.yml
  with_items: "{{ result.json }}"
