---
sources:
  sourceitem:
    type: file
    acknowledgements: true
    ignore_older_secs: 600
    include:
      - "/var/log/nginx/json/*.log"
    read_from: beginning

transforms:
  transformitem:
    type: "json_parser"
    inputs: 
      - sourceitem
    drop_invalid: true
    drop_field: true
    field: message

sinks:
  my_sink_id:
    type: elasticsearch
    inputs:
      - transformitem
    bulk:
      index: "vector-nginx-%Y-%m-%d"
    endpoint: "{{ vector_elasticsearch_url }}"
    mode: bulk
    compression: none
    healthcheck:
      enabled: true
